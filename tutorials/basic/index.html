<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Tutorial for basic usage of the XAD C++ automatic differentiation library for forward and adjoint modes.
"><meta name=author content=Xcelerit><link href=https://auto-differentiation.github.io/tutorials/basic/ rel=canonical><link href=../aad/ rel=prev><link href=../external_functions/ rel=next><link rel=icon href=../../assets/images/favicon.png><meta name=generator content="mkdocs-1.5.3, mkdocs-material-9.5.15"><title>Basic Usage - XAD</title><link rel=stylesheet href=../../assets/stylesheets/main.7e359304.min.css><link rel=stylesheet href=../../assets/stylesheets/palette.06af60db.min.css><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback"><style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style><link rel=stylesheet href=../../custom.css><script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script><meta property=og:type content=website><meta property=og:title content="Basic Usage - XAD"><meta property=og:description content="Tutorial for basic usage of the XAD C++ automatic differentiation library for forward and adjoint modes.
"><meta property=og:image content=https://auto-differentiation.github.io/assets/images/social/tutorials/basic.png><meta property=og:image:type content=image/png><meta property=og:image:width content=1200><meta property=og:image:height content=630><meta content=https://auto-differentiation.github.io/tutorials/basic/ property=og:url><meta name=twitter:card content=summary_large_image><meta name=twitter:title content="Basic Usage - XAD"><meta name=twitter:description content="Tutorial for basic usage of the XAD C++ automatic differentiation library for forward and adjoint modes.
"><meta name=twitter:image content=https://auto-differentiation.github.io/assets/images/social/tutorials/basic.png><link rel=apple-touch-icon sizes=180x180 href=/favicon/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/favicon/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon/favicon-16x16.png><link rel=manifest href=/favicon/site.webmanifest><link rel=mask-icon href=/favicon/safari-pinned-tab.svg color=#5bbad5><link rel="shortcut icon" href=/favicon/favicon.ico><meta name=msapplication-TileColor content=#ffc40d><meta name=msapplication-config content=/favicon/browserconfig.xml></head> <body dir=ltr data-md-color-scheme=default data-md-color-primary=grey data-md-color-accent=amber> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#basic-usage class=md-skip> Skip to content </a> </div> <div data-md-component=announce> </div> <div data-md-color-scheme=default data-md-component=outdated hidden> </div> <header class="md-header md-header--shadow md-header--lifted" data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Header> <a href=../.. title=XAD class="md-header__button md-logo" aria-label=XAD data-md-component=logo> <img src=../../images/logo.svg alt=logo> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> XAD </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> Basic Usage </span> </div> </div> </div> <form class=md-header__option data-md-component=palette> <input class=md-option data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme=default data-md-color-primary=grey data-md-color-accent=amber aria-hidden=true type=radio name=__palette id=__palette_0> </form> <script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg> </label> <nav class=md-search__options aria-label=Search> <a href=javascript:void(0) class="md-search__icon md-icon" title=Share aria-label=Share data-clipboard data-clipboard-text data-md-component=search-share tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7 0-.24-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91 1.61 0 2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08Z"/></svg> </a> <button type=reset class="md-search__icon md-icon" title=Clear aria-label=Clear tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg> </button> </nav> <div class=md-search__suggest data-md-component=search-suggest></div> </form> <div class=md-search__output> <div class=md-search__scrollwrap data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list role=presentation></ol> </div> </div> </div> </div> </div> <div class=md-header__source> <a href=https://github.com/auto-differentiation/XAD/ title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 496 512"><!-- Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg> </div> <div class=md-source__repository> XAD </div> </a> </div> </nav> <nav class=md-tabs aria-label=Tabs data-md-component=tabs> <div class=md-grid> <ul class=md-tabs__list> <li class=md-tabs__item> <a href=../.. class=md-tabs__link> Home </a> </li> <li class=md-tabs__item> <a href=../../installation/ class=md-tabs__link> Installation </a> </li> <li class="md-tabs__item md-tabs__item--active"> <a href=../aad/ class=md-tabs__link> Tutorials </a> </li> <li class=md-tabs__item> <a href=../../examples/ class=md-tabs__link> Examples </a> </li> <li class=md-tabs__item> <a href=../../quantlib/python/ class=md-tabs__link> QuantLib Integration </a> </li> <li class=md-tabs__item> <a href=../../ref/headers/ class=md-tabs__link> Reference </a> </li> <li class=md-tabs__item> <a href=../../python/ class=md-tabs__link> Python </a> </li> <li class=md-tabs__item> <a href=../../about/ class=md-tabs__link> About </a> </li> </ul> </div> </nav> </header> <div class=md-container data-md-component=container> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary md-nav--lifted" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=../.. title=XAD class="md-nav__button md-logo" aria-label=XAD data-md-component=logo> <img src=../../images/logo.svg alt=logo> </a> XAD </label> <div class=md-nav__source> <a href=https://github.com/auto-differentiation/XAD/ title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 496 512"><!-- Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg> </div> <div class=md-source__repository> XAD </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../.. class=md-nav__link> <span class=md-ellipsis> Home </span> </a> </li> <li class=md-nav__item> <a href=../../installation/ class=md-nav__link> <span class=md-ellipsis> Installation </span> </a> </li> <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3 checked> <label class=md-nav__link for=__nav_3 id=__nav_3_label tabindex> <span class=md-ellipsis> Tutorials </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_3_label aria-expanded=true> <label class=md-nav__title for=__nav_3> <span class="md-nav__icon md-icon"></span> Tutorials </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../aad/ class=md-nav__link> <span class=md-ellipsis> AD Background </span> </a> </li> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> <span class=md-ellipsis> Basic Usage </span> <span class="md-nav__icon md-icon"></span> </label> <a href=./ class="md-nav__link md-nav__link--active"> <span class=md-ellipsis> Basic Usage </span> </a> <nav class="md-nav md-nav--secondary" aria-label=Contents> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#prerequisite-replace-active-variables class=md-nav__link> <span class=md-ellipsis> Prerequisite: Replace Active Variables </span> </a> </li> <li class=md-nav__item> <a href=#forward-mode class=md-nav__link> <span class=md-ellipsis> Forward Mode </span> </a> </li> <li class=md-nav__item> <a href=#adjoint-mode class=md-nav__link> <span class=md-ellipsis> Adjoint Mode </span> </a> </li> <li class=md-nav__item> <a href=#best-practices class=md-nav__link> <span class=md-ellipsis> Best Practices </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../external_functions/ class=md-nav__link> <span class=md-ellipsis> External Functions </span> </a> </li> <li class=md-nav__item> <a href=../checkpointing/ class=md-nav__link> <span class=md-ellipsis> Checkpointing </span> </a> </li> <li class=md-nav__item> <a href=../higher_order/ class=md-nav__link> <span class=md-ellipsis> Higher-Order Derivatives </span> </a> </li> <li class=md-nav__item> <a href=../smoothed_math/ class=md-nav__link> <span class=md-ellipsis> Handling Discontinuities </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../../examples/ class=md-nav__link> <span class=md-ellipsis> Examples </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_5> <label class=md-nav__link for=__nav_5 id=__nav_5_label tabindex=0> <span class=md-ellipsis> QuantLib Integration </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_5_label aria-expanded=false> <label class=md-nav__title for=__nav_5> <span class="md-nav__icon md-icon"></span> QuantLib Integration </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../quantlib/python/ class=md-nav__link> <span class=md-ellipsis> Python </span> </a> </li> <li class=md-nav__item> <a href=../../quantlib/cxx/ class=md-nav__link> <span class=md-ellipsis> C++ </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_6> <label class=md-nav__link for=__nav_6 id=__nav_6_label tabindex=0> <span class=md-ellipsis> Reference </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_6_label aria-expanded=false> <label class=md-nav__title for=__nav_6> <span class="md-nav__icon md-icon"></span> Reference </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../ref/headers/ class=md-nav__link> <span class=md-ellipsis> Headers and Namespaces </span> </a> </li> <li class=md-nav__item> <a href=../../ref/interface/ class=md-nav__link> <span class=md-ellipsis> AD Mode Interface </span> </a> </li> <li class=md-nav__item> <a href=../../ref/freal/ class=md-nav__link> <span class=md-ellipsis> Forward Mode Type FReal </span> </a> </li> <li class=md-nav__item> <a href=../../ref/areal/ class=md-nav__link> <span class=md-ellipsis> Adjoint Mode Type AReal </span> </a> </li> <li class=md-nav__item> <a href=../../ref/global/ class=md-nav__link> <span class=md-ellipsis> Global Functions </span> </a> </li> <li class=md-nav__item> <a href=../../ref/math/ class=md-nav__link> <span class=md-ellipsis> Mathematical Operations </span> </a> </li> <li class=md-nav__item> <a href=../../ref/complex/ class=md-nav__link> <span class=md-ellipsis> Complex </span> </a> </li> <li class=md-nav__item> <a href=../../ref/smooth-math/ class=md-nav__link> <span class=md-ellipsis> Smoothed Mathematical Functions </span> </a> </li> <li class=md-nav__item> <a href=../../ref/expressions/ class=md-nav__link> <span class=md-ellipsis> Expressions </span> </a> </li> <li class=md-nav__item> <a href=../../ref/tape/ class=md-nav__link> <span class=md-ellipsis> Tape </span> </a> </li> <li class=md-nav__item> <a href=../../ref/chkpt_cb/ class=md-nav__link> <span class=md-ellipsis> CheckpointCallback </span> </a> </li> <li class=md-nav__item> <a href=../../ref/exceptions/ class=md-nav__link> <span class=md-ellipsis> Exceptions </span> </a> </li> <li class=md-nav__item> <a href=../../ref/version/ class=md-nav__link> <span class=md-ellipsis> Version Information </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../../python/ class=md-nav__link> <span class=md-ellipsis> Python </span> </a> </li> <li class=md-nav__item> <a href=../../about/ class=md-nav__link> <span class=md-ellipsis> About </span> </a> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label=Contents> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#prerequisite-replace-active-variables class=md-nav__link> <span class=md-ellipsis> Prerequisite: Replace Active Variables </span> </a> </li> <li class=md-nav__item> <a href=#forward-mode class=md-nav__link> <span class=md-ellipsis> Forward Mode </span> </a> </li> <li class=md-nav__item> <a href=#adjoint-mode class=md-nav__link> <span class=md-ellipsis> Adjoint Mode </span> </a> </li> <li class=md-nav__item> <a href=#best-practices class=md-nav__link> <span class=md-ellipsis> Best Practices </span> </a> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <h1 id=basic-usage>Basic Usage<a class=headerlink href=#basic-usage title="Permanent link">&para;</a></h1> <p>In this section, we will illustrate how to use XAD to compute first order derivatives in both forward and adjoint mode.</p> <p>As an example, we choose a simple function with 4 inputs and 1 output variable, defined as:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-0-1 name=__codelineno-0-1 href=#__codelineno-0-1></a><span class=kt>double</span><span class=w> </span><span class=nf>f</span><span class=p>(</span><span class=kt>double</span><span class=w> </span><span class=n>x0</span><span class=p>,</span><span class=w> </span><span class=kt>double</span><span class=w> </span><span class=n>x1</span><span class=p>,</span><span class=w> </span><span class=kt>double</span><span class=w> </span><span class=n>x2</span><span class=p>,</span><span class=w> </span><span class=kt>double</span><span class=w> </span><span class=n>x3</span><span class=p>)</span>
<a id=__codelineno-0-2 name=__codelineno-0-2 href=#__codelineno-0-2></a><span class=p>{</span>
<a id=__codelineno-0-3 name=__codelineno-0-3 href=#__codelineno-0-3></a><span class=w>    </span><span class=kt>double</span><span class=w> </span><span class=n>a</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>sin</span><span class=p>(</span><span class=n>x0</span><span class=p>)</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=n>cos</span><span class=p>(</span><span class=n>x1</span><span class=p>);</span>
<a id=__codelineno-0-4 name=__codelineno-0-4 href=#__codelineno-0-4></a><span class=w>    </span><span class=kt>double</span><span class=w> </span><span class=n>b</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>x2</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=n>x3</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=n>tan</span><span class=p>(</span><span class=n>x1</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=n>x2</span><span class=p>);</span>
<a id=__codelineno-0-5 name=__codelineno-0-5 href=#__codelineno-0-5></a><span class=w>    </span><span class=kt>double</span><span class=w> </span><span class=n>c</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>a</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=mi>2</span><span class=o>*</span><span class=w> </span><span class=n>c</span><span class=p>;</span>
<a id=__codelineno-0-6 name=__codelineno-0-6 href=#__codelineno-0-6></a><span class=w>    </span><span class=k>return</span><span class=w> </span><span class=n>c</span><span class=o>*</span><span class=n>c</span><span class=p>;</span>
<a id=__codelineno-0-7 name=__codelineno-0-7 href=#__codelineno-0-7></a><span class=p>}</span>
</code></pre></div> <p>We will compute derivatives of this function at the point:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-1-1 name=__codelineno-1-1 href=#__codelineno-1-1></a><span class=kt>double</span><span class=w> </span><span class=n>x0</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mf>1.0</span><span class=p>;</span>
<a id=__codelineno-1-2 name=__codelineno-1-2 href=#__codelineno-1-2></a><span class=kt>double</span><span class=w> </span><span class=n>x1</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mf>1.5</span><span class=p>;</span>
<a id=__codelineno-1-3 name=__codelineno-1-3 href=#__codelineno-1-3></a><span class=kt>double</span><span class=w> </span><span class=n>x2</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mf>1.3</span><span class=p>;</span>
<a id=__codelineno-1-4 name=__codelineno-1-4 href=#__codelineno-1-4></a><span class=kt>double</span><span class=w> </span><span class=n>x3</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mf>1.2</span><span class=p>;</span>
</code></pre></div> <h2 id=prerequisite-replace-active-variables>Prerequisite: Replace Active Variables<a class=headerlink href=#prerequisite-replace-active-variables title="Permanent link">&para;</a></h2> <p>In order to use XAD to differentiate this function, we first must replace all independent data types and all values that depend on them with an active data type provided by XAD. In the above function, all variables depend on the inputs and thus all occurrences of <code class=highlight><span class=kt>double</span></code> must be replaced.</p> <p>This can be done in one of two ways:</p> <ol> <li>The variables can be replaced directly, given the desired mode of differentiation. For example, for forward mode <code class=highlight><span class=kt>double</span></code> is replaced by the type <a href=../../ref/freal/ ><code>FReal</code></a> and for adjoint mode the type <a href=../../ref/areal/ ><code>AReal</code></a>.</li> <li>The function is made a template, so that it can be called with any data type, including the original <code class=highlight><span class=kt>double</span></code>.</li> </ol> <p>We choose the second approach for this tutorial, thus the function becomes:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-2-1 name=__codelineno-2-1 href=#__codelineno-2-1></a><span class=k>template</span><span class=w> </span><span class=o>&lt;</span><span class=k>class</span><span class=w> </span><span class=nc>T</span><span class=o>&gt;</span>
<a id=__codelineno-2-2 name=__codelineno-2-2 href=#__codelineno-2-2></a><span class=n>T</span><span class=w> </span><span class=n>f</span><span class=p>(</span><span class=n>T</span><span class=w> </span><span class=n>x0</span><span class=p>,</span><span class=w> </span><span class=n>T</span><span class=w> </span><span class=n>x1</span><span class=p>,</span><span class=w> </span><span class=n>T</span><span class=w> </span><span class=n>x2</span><span class=p>,</span><span class=w> </span><span class=n>T</span><span class=w> </span><span class=n>x3</span><span class=p>)</span>
<a id=__codelineno-2-3 name=__codelineno-2-3 href=#__codelineno-2-3></a><span class=p>{</span>
<a id=__codelineno-2-4 name=__codelineno-2-4 href=#__codelineno-2-4></a><span class=w>    </span><span class=n>T</span><span class=w> </span><span class=n>a</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>sin</span><span class=p>(</span><span class=n>x0</span><span class=p>)</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=n>cos</span><span class=p>(</span><span class=n>x1</span><span class=p>);</span>
<a id=__codelineno-2-5 name=__codelineno-2-5 href=#__codelineno-2-5></a><span class=w>    </span><span class=n>T</span><span class=w> </span><span class=n>b</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>x2</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=n>x3</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=n>tan</span><span class=p>(</span><span class=n>x1</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=n>x2</span><span class=p>);</span>
<a id=__codelineno-2-6 name=__codelineno-2-6 href=#__codelineno-2-6></a><span class=w>    </span><span class=n>T</span><span class=w> </span><span class=n>c</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>a</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=mi>2</span><span class=o>*</span><span class=w> </span><span class=n>b</span><span class=p>;</span>
<a id=__codelineno-2-7 name=__codelineno-2-7 href=#__codelineno-2-7></a><span class=w>    </span><span class=k>return</span><span class=w> </span><span class=n>c</span><span class=o>*</span><span class=n>c</span><span class=p>;</span>
<a id=__codelineno-2-8 name=__codelineno-2-8 href=#__codelineno-2-8></a><span class=p>}</span>
</code></pre></div> <p>This means we can use the same definition with both forward and adjoint modes.</p> <h2 id=forward-mode>Forward Mode<a class=headerlink href=#forward-mode title="Permanent link">&para;</a></h2> <p>As illustrated in <a href=../aad/#forward-mode>Algorithmic Differentiation Background: Forward Mode</a>, when applied to a function with a single output, the forward mode of algorithmic differentiation can compute <em>one</em> derivative at a time. For illustration, we choose to derive the function with respect to the input variable <code>x0</code>.</p> <p>To initiate the forward mode, we must first declare active variables with the appropriate type. XAD provides convenience typedefs to select the mode of differentiation, illustrated in detail in <a href=../../ref/interface/ >AD Mode Interface</a>. For forward mode, we can declare the types needed as:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-3-1 name=__codelineno-3-1 href=#__codelineno-3-1></a><span class=k>typedef</span><span class=w> </span><span class=n>xad</span><span class=o>::</span><span class=n>fwd</span><span class=o>&lt;</span><span class=kt>double</span><span class=o>&gt;</span><span class=w> </span><span class=n>mode</span><span class=p>;</span>
<a id=__codelineno-3-2 name=__codelineno-3-2 href=#__codelineno-3-2></a><span class=k>typedef</span><span class=w> </span><span class=n>mode</span><span class=o>::</span><span class=n>active_type</span><span class=w> </span><span class=n>AD</span><span class=p>;</span>
</code></pre></div> <p>We can then use the <code>AD</code> typedef for our variables.</p> <p>The next step is to initialize the dependent variables, which is simply done by assigning the input values to new variables of type <code>AD</code>:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-4-1 name=__codelineno-4-1 href=#__codelineno-4-1></a><span class=n>AD</span><span class=w> </span><span class=n>x0_ad</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>x0</span><span class=p>;</span>
<a id=__codelineno-4-2 name=__codelineno-4-2 href=#__codelineno-4-2></a><span class=n>AD</span><span class=w> </span><span class=n>x1_ad</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>x1</span><span class=p>;</span>
<a id=__codelineno-4-3 name=__codelineno-4-3 href=#__codelineno-4-3></a><span class=n>AD</span><span class=w> </span><span class=n>x2_ad</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>x2</span><span class=p>;</span>
<a id=__codelineno-4-4 name=__codelineno-4-4 href=#__codelineno-4-4></a><span class=n>AD</span><span class=w> </span><span class=n>x3_ad</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>x3</span><span class=p>;</span>
</code></pre></div> <p>For forward mode, we must now seed the initial derivative for the variable we are interested in with the value 1 (as described in <a href=../aad/#forward-mode>Algorithmic Differentiation Background: Forward Mode</a>), as:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-5-1 name=__codelineno-5-1 href=#__codelineno-5-1></a><span class=n>derivative</span><span class=p>(</span><span class=n>x0_ad</span><span class=p>)</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mf>1.0</span><span class=p>;</span>
</code></pre></div> <p>The global function <a href=../../ref/global/#derivative><code>derivative</code></a> is a convenience function that works on any active data type. Alternatively, we could have used the member function <a href=../../ref/freal/#setderivative><code>FReal::setDerivative</code></a>.</p> <p>At this point we are ready to call our function and it will compute the function value as well as the derivative we are interested in:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-6-1 name=__codelineno-6-1 href=#__codelineno-6-1></a><span class=n>AD</span><span class=w> </span><span class=n>y</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>f</span><span class=p>(</span><span class=n>x0_ad</span><span class=p>,</span><span class=w> </span><span class=n>x1_ad</span><span class=p>,</span><span class=w> </span><span class=n>x2_ad</span><span class=p>,</span><span class=w> </span><span class=n>x3_ad</span><span class=p>);</span>
</code></pre></div> <p>We can now access the results using the <a href=../../ref/global/#value><code>value</code></a> and <a href=../../ref/global/#derivative><code>derivative</code></a> functions on the output (or the member functions <a href=../../ref/freal/#getderivative><code>FReal::getDerivative</code></a> and <a href=../../ref/freal/#getvalue><code>FReal::getValue</code></a>). For example, the following code outputs them to the console:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-7-1 name=__codelineno-7-1 href=#__codelineno-7-1></a><span class=n>std</span><span class=o>::</span><span class=n>cout</span><span class=w> </span><span class=o>&lt;&lt;</span><span class=w> </span><span class=s>&quot;y = &quot;</span><span class=w> </span><span class=o>&lt;&lt;</span><span class=w> </span><span class=n>value</span><span class=p>(</span><span class=n>y</span><span class=p>)</span><span class=w> </span><span class=o>&lt;&lt;</span><span class=w> </span><span class=s>&quot;</span><span class=se>\n</span><span class=s>&quot;</span>
<a id=__codelineno-7-2 name=__codelineno-7-2 href=#__codelineno-7-2></a><span class=w>          </span><span class=o>&lt;&lt;</span><span class=w> </span><span class=s>&quot;dy/dx0 = &quot;</span><span class=w> </span><span class=o>&lt;&lt;</span><span class=w> </span><span class=n>derivative</span><span class=p>(</span><span class=n>y</span><span class=p>)</span><span class=w> </span><span class=o>&lt;&lt;</span><span class=w> </span><span class=s>&quot;</span><span class=se>\n</span><span class=s>&quot;</span><span class=p>;</span>
</code></pre></div> <div class="admonition note"> <p class=admonition-title>See also</p> <p>This example is included with XAD (<a href=https://github.com/auto-differentiation/XAD/tree/main/samples/fwd_1st><code>fwd_1st</code></a>).</p> </div> <h2 id=adjoint-mode>Adjoint Mode<a class=headerlink href=#adjoint-mode title="Permanent link">&para;</a></h2> <p>The adjoint mode of automatic differentiation is the natural choice for the function at hand, as it has a single output and multiple inputs. We can get all four derivatives in one execution.</p> <p>Adjoint mode needs a tape to record the operations and their values during the valuation. After setting the adjoints of the outputs, this tape can then be rolled back to compute the adjoints of the inputs.</p> <p>Both the active data type and the tape type can be obtained from the interface structure <a href=../../ref/interface/#adjt><code>adj</code></a>:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-8-1 name=__codelineno-8-1 href=#__codelineno-8-1></a><span class=k>typedef</span><span class=w> </span><span class=n>xad</span><span class=o>::</span><span class=n>adj</span><span class=o>&lt;</span><span class=kt>double</span><span class=o>&gt;</span><span class=w> </span><span class=n>mode</span><span class=p>;</span>
<a id=__codelineno-8-2 name=__codelineno-8-2 href=#__codelineno-8-2></a><span class=k>typedef</span><span class=w> </span><span class=n>mode</span><span class=o>::</span><span class=n>tape_type</span><span class=w> </span><span class=n>tape_type</span><span class=p>;</span>
<a id=__codelineno-8-3 name=__codelineno-8-3 href=#__codelineno-8-3></a><span class=k>typedef</span><span class=w> </span><span class=n>mode</span><span class=o>::</span><span class=n>active_type</span><span class=w> </span><span class=n>AD</span><span class=p>;</span>
</code></pre></div> <p>The first step for computing adjoints is to initialise the tape::</p> <div class=highlight><pre><span></span><code><a id=__codelineno-9-1 name=__codelineno-9-1 href=#__codelineno-9-1></a><span class=n>tape_type</span><span class=w> </span><span class=n>tape</span><span class=p>;</span>
</code></pre></div> <p>This calls the default constructor <a href=../../ref/tape/#construct-destruct-and-assign><code>Tape::Tape</code></a>, which creates the tape and activates it.</p> <p>Next, we create the input variables and register them with the tape:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-10-1 name=__codelineno-10-1 href=#__codelineno-10-1></a><span class=n>AD</span><span class=w> </span><span class=n>x0_ad</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>x0</span><span class=p>;</span>
<a id=__codelineno-10-2 name=__codelineno-10-2 href=#__codelineno-10-2></a><span class=n>AD</span><span class=w> </span><span class=n>x1_ad</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>x1</span><span class=p>;</span>
<a id=__codelineno-10-3 name=__codelineno-10-3 href=#__codelineno-10-3></a><span class=n>AD</span><span class=w> </span><span class=n>x2_ad</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>x2</span><span class=p>;</span>
<a id=__codelineno-10-4 name=__codelineno-10-4 href=#__codelineno-10-4></a><span class=n>AD</span><span class=w> </span><span class=n>x3_ad</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>x3</span><span class=p>;</span>
<a id=__codelineno-10-5 name=__codelineno-10-5 href=#__codelineno-10-5></a><span class=n>tape</span><span class=p>.</span><span class=n>registerInput</span><span class=p>(</span><span class=n>x0</span><span class=p>);</span>
<a id=__codelineno-10-6 name=__codelineno-10-6 href=#__codelineno-10-6></a><span class=n>tape</span><span class=p>.</span><span class=n>registerInput</span><span class=p>(</span><span class=n>x1</span><span class=p>);</span>
<a id=__codelineno-10-7 name=__codelineno-10-7 href=#__codelineno-10-7></a><span class=n>tape</span><span class=p>.</span><span class=n>registerInput</span><span class=p>(</span><span class=n>x2</span><span class=p>);</span>
<a id=__codelineno-10-8 name=__codelineno-10-8 href=#__codelineno-10-8></a><span class=n>tape</span><span class=p>.</span><span class=n>registerInput</span><span class=p>(</span><span class=n>x3</span><span class=p>);</span>
</code></pre></div> <p>Note that only variables registered as inputs with the tape and all variables dependent on them are recorded. Also note that before registering active variables, the current threads needs to have an active tape. To ensure thread-safety, every thread of the application can have its own active tape.</p> <p>Once the independent variables are set, we can start recording derivatives on tape and run the algorithm:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-11-1 name=__codelineno-11-1 href=#__codelineno-11-1></a><span class=n>tape</span><span class=p>.</span><span class=n>newRecording</span><span class=p>();</span>
<a id=__codelineno-11-2 name=__codelineno-11-2 href=#__codelineno-11-2></a>
<a id=__codelineno-11-3 name=__codelineno-11-3 href=#__codelineno-11-3></a><span class=n>AD</span><span class=w> </span><span class=n>y</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>f</span><span class=p>(</span><span class=n>x0_ad</span><span class=p>,</span><span class=w> </span><span class=n>x1_ad</span><span class=p>,</span><span class=w> </span><span class=n>x2_ad</span><span class=p>,</span><span class=w> </span><span class=n>x3_ad</span><span class=p>);</span>
</code></pre></div> <p>At this stage, we have all operations recorded and have the value computed. We now need to register the outputs with the tape as well, before we can seed the initial adjoint of the output wit 1 as explained in <a href=../aad/#adjoint-mode>Algorithmic Differentiation Background: Adjoint Mode</a>:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-12-1 name=__codelineno-12-1 href=#__codelineno-12-1></a><span class=n>tape</span><span class=p>.</span><span class=n>registerOutput</span><span class=p>(</span><span class=n>y</span><span class=p>);</span>
<a id=__codelineno-12-2 name=__codelineno-12-2 href=#__codelineno-12-2></a><span class=n>derivative</span><span class=p>(</span><span class=n>y</span><span class=p>)</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mf>1.0</span><span class=p>;</span>
</code></pre></div> <p>This uses the global function <a href=../../ref/global/#derivative><code>derivative</code></a>, which returns a reference to the stored derivative (or adjoint) of the given parameter. Alternatively the member functions <a href=../../ref/areal/#setadjoint><code>AReal::setAdjoint</code></a> or <a href=../../ref/areal/#setderivative><code>AReal::setDerivative</code></a> can be used for the same purpose.</p> <p>What is left is interpreting the tape to compute the adjoints of the independent variables:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-13-1 name=__codelineno-13-1 href=#__codelineno-13-1></a><span class=n>tape</span><span class=p>.</span><span class=n>computeAdjoints</span><span class=p>();</span>
</code></pre></div> <p>We can now access the adjoints of the inputs, which are the derivatives we are interested in, via the global <a href=../../ref/global/#derivative><code>derivative</code></a> function or the member function <a href=../../ref/areal/#getderivative><code>AReal::getDerivative</code></a>:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-14-1 name=__codelineno-14-1 href=#__codelineno-14-1></a><span class=n>std</span><span class=o>::</span><span class=n>cout</span><span class=w> </span><span class=o>&lt;&lt;</span><span class=w> </span><span class=s>&quot;y     = &quot;</span><span class=w> </span><span class=o>&lt;&lt;</span><span class=w> </span><span class=n>value</span><span class=p>(</span><span class=n>y</span><span class=p>)</span><span class=w> </span><span class=o>&lt;&lt;</span><span class=w> </span><span class=s>&quot;</span><span class=se>\n</span><span class=s>&quot;</span>
<a id=__codelineno-14-2 name=__codelineno-14-2 href=#__codelineno-14-2></a><span class=w>          </span><span class=o>&lt;&lt;</span><span class=w> </span><span class=s>&quot;dy/dx0 = &quot;</span><span class=w> </span><span class=o>&lt;&lt;</span><span class=w> </span><span class=n>derivative</span><span class=p>(</span><span class=n>x0_ad</span><span class=p>)</span><span class=w> </span><span class=o>&lt;&lt;</span><span class=w> </span><span class=s>&quot;</span><span class=se>\n</span><span class=s>&quot;</span>
<a id=__codelineno-14-3 name=__codelineno-14-3 href=#__codelineno-14-3></a><span class=w>          </span><span class=o>&lt;&lt;</span><span class=w> </span><span class=s>&quot;dy/dx1 = &quot;</span><span class=w> </span><span class=o>&lt;&lt;</span><span class=w> </span><span class=n>derivative</span><span class=p>(</span><span class=n>x1_ad</span><span class=p>)</span><span class=w> </span><span class=o>&lt;&lt;</span><span class=w> </span><span class=s>&quot;</span><span class=se>\n</span><span class=s>&quot;</span>
<a id=__codelineno-14-4 name=__codelineno-14-4 href=#__codelineno-14-4></a><span class=w>          </span><span class=o>&lt;&lt;</span><span class=w> </span><span class=s>&quot;dy/dx2 = &quot;</span><span class=w> </span><span class=o>&lt;&lt;</span><span class=w> </span><span class=n>derivative</span><span class=p>(</span><span class=n>x2_ad</span><span class=p>)</span><span class=w> </span><span class=o>&lt;&lt;</span><span class=w> </span><span class=s>&quot;</span><span class=se>\n</span><span class=s>&quot;</span>
<a id=__codelineno-14-5 name=__codelineno-14-5 href=#__codelineno-14-5></a><span class=w>          </span><span class=o>&lt;&lt;</span><span class=w> </span><span class=s>&quot;dy/dx3 = &quot;</span><span class=w> </span><span class=o>&lt;&lt;</span><span class=w> </span><span class=n>derivative</span><span class=p>(</span><span class=n>x3_ad</span><span class=p>)</span><span class=w> </span><span class=o>&lt;&lt;</span><span class=w> </span><span class=s>&quot;</span><span class=se>\n</span><span class=s>&quot;</span><span class=p>;</span>
</code></pre></div> <div class="admonition note"> <p class=admonition-title>See also</p> <p>This example is included with XAD (<a href=https://github.com/auto-differentiation/XAD/tree/main/samples/adj_1st><code>adj_1st</code></a>).</p> </div> <h2 id=best-practices>Best Practices<a class=headerlink href=#best-practices title="Permanent link">&para;</a></h2> <p>When the algorithm to be evaluated has less outputs than inputs, adjoint mode should be preferred. However, when only a small number of derivatives are needed (e.g. less than 5), the memory for the tape can be avoided by using forward mode. Experimentation is advised to find the optimal mode for the given algorithm.</p> </article> </div> <script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script> </div> <button type=button class="md-top md-icon" data-md-component=top hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg> Back to top </button> </main> <footer class=md-footer> <nav class="md-footer__inner md-grid" aria-label=Footer> <a href=../aad/ class="md-footer__link md-footer__link--prev" aria-label="Previous: AD Background"> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg> </div> <div class=md-footer__title> <span class=md-footer__direction> Previous </span> <div class=md-ellipsis> AD Background </div> </div> </a> <a href=../external_functions/ class="md-footer__link md-footer__link--next" aria-label="Next: External Functions"> <div class=md-footer__title> <span class=md-footer__direction> Next </span> <div class=md-ellipsis> External Functions </div> </div> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg> </div> </a> </nav> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> <div class=md-copyright__highlight> Copyright &copy; 2010-2024, Xcelerit Computing Limited </div> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <script id=__config type=application/json>{"base": "../..", "features": ["toc.follow", "navigation.tabs", "navigation.tabs.sticky", "navigation.top", "navigation.tracking", "navigation.footer", "navigation.indexes", "navigation.sections", "search.highlight", "search.share", "search.suggest", "content.code.copy"], "search": "../../assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": "v1.5.0"}</script> <script src=../../assets/javascripts/bundle.bd41221c.min.js></script> <script src=../../javascripts/mathjax.js></script> <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js></script> </body> </html>